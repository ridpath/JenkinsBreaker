# Jenkins Lab Plugin Vulnerability Mapping

This document maps which plugin versions are installed to test specific CVEs.

## Core Requirements

**Jenkins Version**: `2.138.3` (December 2018)
- Vulnerable to: CVE-2018-1000861, CVE-2019-xxx series, CVE-2020-2100
- Safe from: CVE-2024-xxx (these target Jenkins 2.400+)

## Plugin Vulnerability Matrix

### script-security Plugin

| Version | CVEs Testable | Notes |
|---------|---------------|-------|
| 1.53 (current) | CVE-2019-1003029, CVE-2019-1003040 | Good for 2019 CVEs |
| Need: 1.50 or earlier | CVE-2019-1003000 | For AST transformation bypass |
| Need: 1.175.x | CVE-2022-43401 | For implicit cast bypass |
| Need: 1.228.x | CVE-2023-24422 | For map constructor bypass |
| Need: 1.335.x | CVE-2024-34144 | For constructor body bypass |

**Recommendation**: Keep 1.53 for now (covers most critical 2019 CVEs)

### workflow-cps (Pipeline) Plugin

| Version | CVEs Testable | Notes |
|---------|---------------|-------|
| 2.63 (current) | CVE-2019-1003001 | Good for 2019 pipeline bypass |
| Need: 2.689.x | CVE-2022-30945, CVE-2022-43401 | For 2022 vulnerabilities |

**Recommendation**: Keep 2.63 (covers 2019 CVEs)

### credentials Plugin

| Version | CVEs Testable | Notes |
|---------|---------------|-------|
| 2.1.18 (current) | General credential exposure CVEs | Baseline version |

**Recommendation**: Keep current version

### ssh-slaves (Agent) Plugin

| Version | CVEs Testable | Notes |
|---------|---------------|-------|
| 1.29.4 (current) | CVE-2021-21686 (needs Jenkins 2.303+) | Agent path traversal |

**Recommendation**: Keep current, but requires newer Jenkins for CVE-2024-43044

### git Plugin

| Version | CVEs Testable | Notes |
|---------|---------------|-------|
| 3.9.3 (current) | CVE-2018-1000600 | Need version <= 1.29.1 in GitHub plugin |

**Recommendation**: Need to add github plugin <= 1.29.1

### Missing Plugins Needed

| Plugin | Version Needed | CVEs |
|--------|----------------|------|
| github | <= 1.29.1 | CVE-2018-1000600 |
| maven-plugin | <= 3.3 | CVE-2019-10358 |
| tfs | <= 5.157.0 | CVE-2020-2249 |
| pipeline-input-step | <= 448.vXXX | CVE-2022-34177 |
| templating-engine | <= 2.5.3 | CVE-2025-31722 |
| aws-codedeploy | <= 1.19 | CVE-2018-1000402 (ALREADY HAVE 1.19!) |

## Current Plugin List Status

✓ Already Installed:
- script-security:1.53 (good for CVE-2019-1003029, CVE-2019-1003040)
- workflow-cps:2.63 (good for CVE-2019-1003001)
- credentials:2.1.18
- ssh-slaves:1.29.4
- git:3.9.3, git-client:2.7.6, git-server:1.7
- aws-codedeploy:1.19 (vulnerable version! ✓)

✗ Missing/Need to Add:
- github:<= 1.29.1 (for CVE-2018-1000600)
- maven-plugin:3.3 (for CVE-2019-10358)
- tfs:5.157.0 (for CVE-2020-2249)
- pipeline-input-step:448 or earlier (for CVE-2022-34177)
- templating-engine-plugin:2.5.3 (for CVE-2025-31722)

## Testability by CVE

### Currently Testable (Jenkins 2.138.3 + Current Plugins)

✓ **Working Now**:
1. CVE-2018-1000861 - Stapler ACL bypass (core vulnerability)
2. CVE-2019-1003029 - Script Security sandbox bypass (VERIFIED WORKING)
3. CVE-2019-1003040 - Script Security constructor bypass (script-security 1.53)
4. CVE-2019-1003001 - Pipeline Groovy bypass (workflow-cps 2.63)
5. CVE-2018-1000402 - AWS CodeDeploy credential exposure (aws-codedeploy 1.19 installed!)
6. FEATURE-SCRIPT-CONSOLE - Admin RCE (VERIFIED WORKING)

### Testable with Plugin Additions

✓ **Add Plugins**:
1. CVE-2018-1000600 - GitHub plugin file read (add github:1.29.1)
2. CVE-2019-10358 - Maven credential disclosure (add maven-plugin:3.3)
3. CVE-2020-2249 - TFS credential exposure (add tfs:5.157.0)
4. CVE-2022-34177 - Pipeline input file write (add pipeline-input-step:448)
5. CVE-2025-31722 - Templating engine RCE (add templating-engine:2.5.3)

### Not Testable (Wrong Jenkins Version)

✗ **Requires Jenkins 2.200+**:
1. CVE-2020-2100 - UDP amplification (Jenkins < 2.204.2)
2. CVE-2021-21602 - Workspace file read (Jenkins <= 2.274)
3. CVE-2021-21686 - Agent path traversal (Jenkins < 2.318)

✗ **Requires Jenkins 2.400+**:
1. CVE-2024-23897 - CLI file read (Jenkins <= 2.441)
2. CVE-2024-34144 - Script Security bypass (script-security <= 1.335.x)
3. CVE-2024-43044 - Agent file read to RCE (Jenkins <= 2.470)
4. CVE-2024-47803 - Multi-line secret exposure (Jenkins <= 2.478)

✗ **Requires Newer Plugins (Breaking Changes)**:
1. CVE-2022-30945 - Pipeline Groovy injection (workflow-cps 2.689+)
2. CVE-2022-43401 - Sandbox bypass (script-security 1.175+, workflow-cps 2.689+)
3. CVE-2023-24422 - Map constructor bypass (script-security 1.228+)

✗ **Not Applicable**:
1. CVE-2023-3519 - Citrix NetScaler (NOT a Jenkins CVE)

## Recommended Plugin Updates

Add to `jenkins-lab/jenkins/plugins.txt`:

```
github:1.29.1
maven-plugin:3.3
tfs:5.157.0
pipeline-input-step:448.v37cea_9a_10a_70
templating-engine-plugin:2.5.3
```

## Final Testability Summary

**With Current Setup**: 6 CVEs testable (23%)
**With Plugin Additions**: 11 CVEs testable (42%)
**Not Testable (Jenkins Version)**: 11 CVEs (42%)
**Not Applicable**: 1 CVE (4%)

**Total Modules**: 27 (25 CVEs + 2 Features)

## Alternative Approach for Fuller Coverage

To test ALL CVEs, we would need:

1. **Multiple Jenkins Lab Versions**:
   - jenkins-lab-old: 2.138.3 (current) - For 2018-2019 CVEs
   - jenkins-lab-mid: 2.275 - For 2020-2021 CVEs
   - jenkins-lab-new: 2.442 - For 2024 CVEs

2. **Plugin Version Matrix**: Different plugin versions per Jenkins version

This would be the most comprehensive approach for full test coverage.
